# AWS資格

クラスタプレイスメントグループの作成　多数のインスタンスを起動して並列処理のためインスタンス間のネットワークレイテンシを低く抑えるサービス
　　　　　　　　　　　　　　　　　　　同じAZ内のインスタンスを論理的にグループ化したもの。

Amazon RDSを削除した場合　手動スナップショット/自動バックアップは保持される。

ボリュームステータスチェックの結果で「insufficient-data」はボリュームチェックを実行中を表す。

"起動時"にインスタンスを誤って削除できないようにするには、[Enable termination Protection]チェックボタンをオンにする。

一つのインスタンスに対してトラヒックを制御するFWとして機能するサービスはセキュリティグループ

APLがS3バケットは全リージョンでPUT及びDELETEの上書きについて結果整合性を提供している。
　→ 古いデータがまれに表示される問題が発生する。

## リージョン

AWSサービスは世界中の複数のリージョンで利用でき、DRサイトの場所はプライマリサイトの場所に加えて適切に選択できます。

## ストレージ

### Amazon S3

ミッションクリティカルでプライマリなデータストレージ用に設計された耐久性の高い（99.999999999％）ストレージインフラストラクチャを提供します。
リージョン内の複数の施設にまたがって複数のデバイスに重複してオブジェクトを格納します。

#### Amazon Glacier

データのアーカイブとバックアップに非常に低コストのストレージを提供します。
オブジェクトは頻繁にアクセスされないように最適化されており、検索時間は数(3-5)時間で十分です。

### Amazon EBS

データボリュームのポイントインタイムスナップショットを作成する機能を提供します。
スナップショットを使用してボリュームを作成し、実行中のインスタンスにアタッチすることができます。

### Amazon ストレージゲートウェイ

オンプレミスのIT環境とAWSのストレージインフラストラクチャとのシームレスで安全性の高い統合を実現するサービスです。

### AWS Import/Export

インターネットを迂回するポータブルストレージデバイスを使用して大量のデータをAWSとの間で移動させることを加速します。
Amazonの高速内部ネットワークを使用して、ストレージデバイスに直接データを転送します。

## Compute

### Amazon EC2

クラウドにサイズ変更可能な計算能力を提供し、容易に作成および拡張することができます。
事前設定されたAMIを使用したEC2インスタンスの作成。
EC2インスタンスは、他のAZの障害から隔離されるように設計された複数のAZで起動できます。

## アクセス管理

### JSONポリシーの検証

Policy Validator(JSON形式)に準拠しないポリシーは保存できない。

## ネットワーキング

### Route53

高可用性と拡張性を備えたDNS Webサービスです。
たとえば、DNSエンドポイントの健全性チェックや複数のエンドポイント間のフェールオーバー機能などのDRシナリオを処理する場合に効果的な、多数のグローバルなロードバランシング機能が含まれています。

### Elastic IP

アドレスは、プログラムで再マッピングすることによってインスタンスまたは可用性ゾーンの障害をマスクすることができます。
アドレスは、動的クラウドコンピューティング用に設計された静的IPアドレスです。

### ELB

ヘルスチェックを実行し、着信アプリケーショントラフィックを複数のEC2インスタンスに自動的に配信する。

### Amazon VPC

定義された仮想ネットワーク内でリソースを起動できる、AWSクラウドの非公開の独立したセクションをプロビジョニングできます。

### ネットワークACL

ネットワークACLのルール番号の評価　低いルール番号から評価される。

### Amazon ダイレクトコネクト

オンプレミス環境からAWSへの専用ネットワーク接続を簡単にセットアップできます。

## データベース

RDS、DynamoDb、Redshiftは、完全に管理されたRDBMS、NoSQLおよびデータウェアハウスソリューションとして提供され、容易に拡張できます。
DynamoDBはクロスリージョンレプリケーションを提供します。
RDSはマルチAZおよびリードレプリカを提供し、あるリージョンから別のリージョンにデータをスナップショットする機能も備えています。

## デプロイメント・オーケストレーション

### CloudFront

開発者やシステム管理者は関連するAWSリソースのコレクションを簡単に作成し、秩序ある予測可能な方法で提供することができます。

### Elastic Beanstalk

Webアプリケーションとサービスの展開とスケーリングのための使いやすいサービスです。

### OpsWork

すべてのタイプとサイズのアプリケーションの配備と操作を容易にするアプリケーション管理サービスです。
環境は一連のレイヤーとして定義でき、各レイヤーはアプリケーションの層として構成できます。
自動的にホストが置換されるため、インスタンスに障害が発生した場合に自動的に置換されます。
環境をテンプレート化する準備段階で使用し、回復段階でAWS CloudFormationと組み合わせることができます。
定義されたRTOをサポートするために、格納された構成からスタックを迅速にプロビジョニングできます。

### 災害計画の主要因

Recovery Time Objective (RTO) – たとえば、RTOが1時間で午後12時（正午）に災害が発生した場合の業務レベル契約（OLA）で定義されているように、ビジネスプロセスをそのサービスレベルに復元するために中断した後、DR プロセスは1時間以内にシステムを許容可能なサービスレベルに復元する必要があります。
Recovery Point Objective (RPO) – 災害発生前に測定されたデータ損失の許容量。 たとえば、午後12:00（正午）に災害が発生し、RPOが1時間である場合、システム内のすべてのデータを午前11:00以降のデータに回復する必要があります。

### 災害復旧のシナリオ

災害復旧のシナリオは、AWSと連携してデータセンターで実行されているプライマリインフラストラクチャで実装できます。
プライマリサイトがAWSマルチリージョン機能を使用してAWSで実行されている場合、災害復旧シナリオは引き続き適用されます。
以下の組み合わせとバリエーションは常に可能です。

### 障害回復シナリオのオプション

1. バックアップと復元（データのバックアップと復元）
1. パイロットライト（最小臨界機能のみ）
1. ウォームスタンバイ（完全機能縮小版）
1. マルチサイト（アクティブ – アクティブ）

DRシナリオオプションの場合、バックアップ＆リストアオプション（左）からマルチサイトオプション（右）に移動すると、RTOとRPOはコストの増加とともに減少します。

### バックアップ＆リストア

AWSを使用すると、費用対効果の高い、耐久性のある安全な方法でデータをバックアップし、データを迅速かつ確実にリカバリすることができます。

### バックアップフェーズ

従来のほとんどの環境では、データはテープにバックアップされ、障害や災害が発生した場合にシステムを復元するために定期的にオフサイトに送信されます。

Amazon S3を使用してデータをバックアップし、迅速なリストアを実行できます。また、任意の場所からも利用できます。
AWSインポート/エクスポートを使用すると、ストレージデバイスをインターネット経由でAWSに直接出荷することで、大きなデータセットを転送できます。
Amazon Glacierは、数時間の検索時間が適切で受け入れやすい、データのアーカイブに使用できます。
AWS Storage Gatewayを使用すると、オンプレミスデータボリュームのスナップショット（作成されたEBSボリュームに使用）をバックアップ用にS3に透過的にコピーできます。 バックアップソリューション（ゲートウェイ格納ボリューム）またはプライマリデータストア（ゲートウェイキャッシュボリューム）として使用できます。
AWS Direct Connectを使用すると、On-PremiseからAmazonまで、一貫して高速でデータを直接転送できます。
Amazon EBSボリューム、Amazon RDSデータベース、Amazon RedshiftデータウェアハウスのスナップショットをAmazon S3に保存できます。

### リストアフェーズ

バックアップしたデータを使用して、ComputeおよびDatabaseインスタンスを迅速にリストアして作成できます。

### バックアップと復元の主な手順

1. 適切なツールまたは方法を選択して、データをAWSにバックアップします。
1. このデータの適切な保持ポリシーを確認します。
1. 暗号化やアクセスポリシーなど、このデータに適切なセキュリティ対策が施されていることを確認します。
1. このデータの復旧とシステムの復旧を定期的にテストします。

### パイロット・ライト

パイロットライトディザスタリカバリのシナリオオプションでは、環境の最小限のバージョンがクラウド内で常に実行されています。クラウドは基本的にデータベースなどのアプリケーションの重要な機能をホストします。

このアプローチでは
AWSでシステムの最も重要なコア要素を設定して実行し、パイロットライトを維持します。 データを複製して更新する必要があるデータベース。
リカバリの間、本格的な生産環境、例えば、 アプリケーションおよびWebサーバーは、クリティカルコアの周りに迅速にプロビジョニングできます（事前構成済みのAMIおよびEBSボリュームスナップショットを使用）。
ネットワークの場合、トラフィックを複数のインスタンスに配布し、DNSがロードバランサを指し示すか、インスタンスが関連付けられた事前割り当てのElastic IPアドレスを使用するELBを使用できます。

### 準備段階

Amazon EC2インスタンスまたはRDSインスタンスを設定して、データの重要なデータを複製またはミラーリングします。
サポートしているすべてのカスタムソフトウェアパッケージがAWSで使用できることを確認します。
迅速な復旧が必要な主要サーバーのAMIを作成して維持する。
これらのサーバーを定期的に実行してテストし、ソフトウェアの更新と構成の変更を適用します。
AWSリソースのプロビジョニングを自動化することを検討してください。

### リカバリーフェーズ

独自のAMIからアプリケーションEC2インスタンスを起動します。
既存のデータベース/データストアインスタンスのサイズを変更して、トラフィックの増加を処理します。たとえば、RDSを使用する場合、EC2インスタンスを水平方向に容易に拡大縮小することができます。
追加のデータベース/データストアインスタンスを追加して、DRサイトの復元力をデータ層に与えます。たとえば、Multi-AZ for RDSをオンにして復元力を向上させます。
Amazon EC2サーバーを指すようにDNSを変更します。
理想的には自動化された方法で、非AMIベースのシステムをインストールして構成します。

### ウォームスタンバイ

ウォームスタンバイ DR シナリオでは、ビジネスクリティカルシステムと完全に同一に機能する環境のスケールダウンバージョンが常にクラウドで実行されます。
この設定は、テスト、品質保証、または内部使用のために使用できます。
災害が発生した場合は、システムを簡単にスケールアップまたはアウトして、生産負荷を処理することができます。

準備段階:
amazon ec2 インスタンスを設定して、データをレプリケートまたはミラーリングします。
より迅速なプロビジョニングのために ami を作成および管理します。
ec2 インスタンスまたは aws インフラストラクチャの最小限のフットプリントを使用してアプリケーションを実行します。
ライブ環境に合わせて、ソフトウェアと構成ファイルを修正して更新します。

リカバリー手順：
サービス内の amazon ec2 フリートのサイズをロードバランサーに増やします。(水平スケーリング)
必要に応じて、より大きな amazon ec2 インスタンスタイプでアプリケーションを起動します。 (垂直スケーリング)
手動で dns レコードを変更するか、ルート53の自動ヘルスチェックを使用して、すべてのトラフィックを aws 環境にルーティングします。
自動スケーリングを使用してフリートを正しいサイズにするか、増加した負荷に対応することを検討してください。
回復力を追加するか、データベースをスケールアップして、DR がダウンするのを防ぐ。

### マルチサイト

マルチサイトはアクティブ-アクティブな構成の DR アプローチであり、同一のソリューションでは、オンサイトインフラストラクチャとして aws 上で実行されます。
トラフィックは、DNS 重み付けルーティングを使用して、必要に応じて両方のインフラストラクチャに均等に分散できます。
災害が発生した場合、DNS はすべてのトラフィックを AWS 環境に送信するように調整でき、AWS インフラストラクチャはそれに応じてスケーリングされます。

準備段階:
運用環境を複製するように AWS 環境を設定します。
DNS の重み付け、または同様のトラフィックルーティングテクノロジを設定して、着信要求を両方のサイトに配布します。
自動フェールオーバーを構成して、影響を受けるサイトからトラフィックを再ルーティングします。たとえば、AWS DB にリダイレクトしない場合にプライマリ DB が使用可能かどうかを確認するアプリケーション

リカバリー手順:
手動または DNS フェールオーバーを使用して、すべての要求が AWS サイトに送信されるように DNS の重み付けを変更します。
すべてのクエリに対してローカル AWS データベースサーバーを使用するために、フェイルオーバー用のアプリケーションロジックを持っている。
自動スケーリングを使用して AWS フリートを自動的に適切なサイズにすることを検討してください。
